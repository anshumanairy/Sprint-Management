<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>
    All Tasks
  </title>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
  <script
        src="https://code.jquery.com/jquery-3.3.1.js"
        integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
        crossorigin="anonymous"></script>
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js"></script>

  <!-- tablesorting -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <script src="/static/tablesorter.js"></script>

  <!-- tablesorting themes -->
  <link rel="stylesheet" type="text/css" href="/static/animate.css">
  <link rel="stylesheet" type="text/css" href="/static/util.css">
  <link rel="stylesheet" type="text/css" href="/static/main.css">
  <script src="/static/main.js"></script>

  {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static '/bootstrap.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static '/paper-dashboard.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static '/w3.css' %}">

  <style media="screen">
    th{
      cursor: pointer;
    }
      .scrollable-menu {
      height: auto;
      max-height: 200px;
      overflow-x: hidden;
    }
    #tab2{
      font-size: 17px;
    }
    body{
      font-family: Montserrat;
      background :#F3F3F3;
    }

    #spr{
      padding-top: 70px;
    }
    #black{
      background-color: black;
      color:white;
      border: 2px solid black;
    }
    #red{
      background-color: red;
      color:white;
      border: 2px solid red;
    }
    #yellow{
      background-color: yellow;
      color:black;
      border: 2px solid yellow;
    }
    #green{
      background-color: #1ea84c;
      color: white;
      border: 2px solid #1ea84c;
    }
    #purple{
      background-color: purple;
      color: white;
      border: 2px solid purple;
    }
    #white{
      background-color: white;
      color: black;
      border: 2px solid black;
    }
    #blue{
      background-color: blue;
      color: white;
      border: 2px solid blue;
    }
    #pd{
      background-color: lightgreen;
      color: black;
      border: 2px solid lightgreen;
    }
    #other{
      background-color: brown;
      color: white;
      border: 2px solid brown;
    }
    td,th{
      text-align: center;
    }
    #una{
      text-align: left;
    }
    .example_c {
    color: black;
    background: lightgrey;
    border: 1px solid lightgrey;
    transition: all 0.4s ease 0s;
    }
    .example_c:hover {
    background: #303D39;
    border: 1px solid #303D39;
    transition: all 0.4s ease 0s;
    }
    #hid{
      float: right;
      padding-top:10px;
    }
    #hid1,#hid3{
      display: inline-block;
    }
    .chosen,#bt1{
      font-size: 14px;
    }
    td,th{
      border: 1px solid lightgrey;
    }
    .js-example-basic-single{
      width: 100%;
    }

  </style>
  {% if messages %}
    <script>
      {% for message in messages %}
        alert("{{ message }}");
      {% endfor %}
    </script>
  {% endif %}
</head>

  <body id="re">
    <div class="w3-sidebar w3-bar-block w3-card w3-animate-left" style="display:none" id="mySidebar">
      <button class="w3-bar-item w3-button w3-large"
      onclick="w3_close()">Close &times;</button>
      <a href="{% url 'product' %}" class="w3-bar-item w3-button">Home Page</a>
      <a href="{% url 'view_story' %}" class="w3-bar-item w3-button">Stories</a>
      <a href="{% url 'qaprg' %}" class="w3-bar-item w3-button">Sprint Progress</a>
      <a href="{% url 'bandwidth' %}" class="w3-bar-item w3-button">Sprint Bandwidth</a>
      <a href="{% url 'tasks' %}l" class="w3-bar-item w3-button">End Sprint Report</a>
      <a href="{% url 'login' %}" class="w3-bar-item w3-button"><b>Logout</b></a>
    </div>

    <div id="main">

      <div class="w3-teal" id="hx1">
        <button id="openNav" class="w3-button w3-teal w3-xlarge" onclick="w3_open()">&#9776;</button>
        All Tasks Dashboard
        <div id="hid">
          <div id="hid3">
            <form class="post-form" method='POST' id="h">
              {% csrf_token %}
              <div class="container-fluid">
                  <div class="col-md-12">
                    <!-- onchange="myFunction(this.value)" -->
                      <select class="js-example-basic-single" name="select_project">
                          <option selected="true" disabled>{{ nx }}</option>
                        {% for n1 in n0 %}
                          <option>{{ n1.name }}</option>
                        {% endfor %}
                      </select>
                  </div>
              </div>
            </form>

            <script>
              $(document).ready(function() {
                  var frm = $('#h');
                  frm.on('change',function (e) {
                    e.preventDefault();
                      $.ajax({
                          type: frm.attr('method'),
                          data: frm.serialize(),
                          success: function(data) {
                            $("#re").html(data);
                          },
                      });
                  });
                });
            </script>
          </div>
          <div id="hid1">
            <form class="post-form" method='POST' id="f5">
              {% csrf_token %}
              <div class="container-fluid">
                  <div class="col-md-12" >
                      <select class="js-example-basic-single" name="select_sprint">
                        <option selected="true" disabled>{{ nx1 }}</option>
                        {% for product in data1 %}
                        <option> {{ product.name }}</option>
                          {% endfor %}
                      </select>
                  </div>
              </div>
            </form>

            <script>
              $(document).ready(function() {
                  var frm = $('#f5');
                  frm.on('change',function (e) {
                    e.preventDefault();
                      $.ajax({
                          type: frm.attr('method'),
                          data: frm.serialize(),
                          success: function(data) {
                            $("#re").html(data);
                          },
                      });
                  });
                });
            </script>
          </div>
          </div>
      </div>

      <script>
      $(document).ready(function() {
          $('.js-example-basic-single').select2();
        });
      </script>

      <!-- <script type="text/javascript">
          var frm = $('#pros');
          frm.submit(function () {
              $.ajax({
                  type: frm.attr('method'),
                  data: frm.serialize(),
                  success: function (data) {
                      $("#re").html(data);
                  },
              });
              return false;
          });
      </script> -->

    <script>
    function w3_open() {
      document.getElementById("main").style.marginLeft = "25%";
      document.getElementById("mySidebar").style.width = "25%";
      document.getElementById("mySidebar").style.display = "block";
      // document.getElementById("openNav").style.display = 'none';
    }
    function w3_close() {
      document.getElementById("main").style.marginLeft = "0%";
      document.getElementById("mySidebar").style.display = "none";
      document.getElementById("openNav").style.display = "inline-block";
    }
    </script>

    <div class="content-fluid">
      <div class="row">
        <div class="col-md-12">
          <div class="card">
            <div class="card-header">
              <h4 class="card-title"><b><u>End Sprint Report</u></b></h4>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table" id="tab2">
                  <thead class="text-primary">
                    <th>Total Available Bandwidth</th>
                    <th>Total Story Points Assigned</th>
                    <th>Total Completed Story Points</th>
                    <th>Total Pending Story Points</th>
                  </thead>
                  <tbody>
                    <tr>
                      {% for i in repo %}
                        <td>{{ i }}</td>
                      {% endfor %}
                    </tr>
                    <tr>
                      <td colspan='2'></td>
                      <td colspan="2">
                        <form method="post">
                          {% csrf_token %}
                          <select class="js-example-basic-single" name="select_spr">
                            {% for n1 in n0 %}
                              <option selected="True" disabled>{{ n1.name }}</option>
                              {% for product in listse %}
                                {% if forloop.counter == forloop.parentloop.counter %}
                                  {% for p in product %}
                                    <option value='{{ p.1 }}'>{{ p.0 }}</option>
                                  {% endfor %}
                                {% endif %}
                              {% endfor %}
                            {% endfor %}
                          </select>
                          <p></p>
                          <button class="btn example_c" type="submit" name="move_story"><small>Move Pending Stories to Selected Sprint</small></button>
                        </form>
                      </td>
                    </tr>
                  </tbody>
                </table>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

<div class="container-fluid">
  <div class="table100 ver3">
    <table class='table' id="tab2" data-vertable="ver1">
      <thead>
        <tr>
          <th id="una">Sprint Name</th>
          <th>Topic</th>
          <th>Jira ID</th>
          <th>Assigned SP</th>
          <th>Pending SP</th>
          <th>Status</th>
          <th>Assign</th>
        </tr>
      </thead>
      <tbody>
          {% for d in list1 %}
            {% for d1 in d %}

          <tr class="w3-animate-left" id="e" style="display:none">
            <form method="GET" id="edit2">
              {% csrf_token %}
              <td>
                <label>Sprint Name</label>
                <input type="text" name="sprint_name" id="a1" value="" readonly>
              </td>
              <td>
                <label>JIRA ID</label>
                <input type="text" name="jira" id="b1" value="" readonly>
              </td>
              <td>
                <label>Skills Available</label>
                <input type="text" id="j1" value="" disabled>
              </td>
              <td>
                <label>Pick Skill</label>
                <input type="text" name="skill">
              </td>
              <td>
                <label>Points</label>
                <input type="number" name="points" min="0" value="0">
              </td>
              <td>
                <input class ="btn example_c" type="submit" value="Assign">
                <p></p>
                <input type="button" class="btn example_c" onclick="w5_close()" value="Dont Assign">
              </td>
            </form>

          </tr>

          <tr class="row100 head">
            <td class="col-md-2" id="una"><a href="/blog" target="_blank">{{ d1.0 }}</a></td>
            <td><a href="/blog" target="_blank">{{ d1.1 }}</a></td>
            <td><a href="{{d1.5}}" target='_blank'>{{ d1.2 }}</a></td>
            <td>{{ d1.6 }}</td>
            <td>{{ d1.7 }}</td>
            <td class='col-md-2' id="{{d1.4}}">{{ d1.3 }}</td>
            <td>
              {% if d1.3 == 'Unassigned' %}
                <button class="btn example_c" type="submit" name="assign_story" onclick="w5_open({{d1.8}})" id="edit"><small>Assign</small></button>
              {% else %}
              {% endif %}
            </td>
          </tr>
            {% endfor %}
          {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<div id="n">
<script>
function w5_open(ex) {
  document.getElementById("n").style.marginTop = "0%";
  document.getElementById("e").style.display = "block";
  document.getElementById("edit").style.display = 'none';

  $(document).ready(function() {
    var d1  = JSON.parse('{{ jd1x|escapejs }}');
    var d2  = JSON.parse('{{ jd2x|escapejs }}');
    var d3  = JSON.parse('{{ jd3x|escapejs }}');

    var a=""
    var b=""
    var j=""
    var p=""
    var h=""
    var q=""

    for(k in d3){
      if(d3[k]=="Java"){
        j="Java";
      }
      if(d3[k]=="PHP"){
        j+=", PHP";
      }
      if(d3[k]=="HTML"){
        j+=", HTML";
      }
      if(d3[k]=="QA"){
        j+=", QA";
      }
    }

    for(i in d2){
      if(ex==Object.keys(d2).indexOf(i)){
        a=d1[i]
        b=d2[i]
        break;
      }
    }
    document.getElementById('a1').value = a;
    document.getElementById('b1').value = b;
    document.getElementById('j1').value = j;
  });
}

function w5_close() {
  document.getElementById("n").style.marginTop = "0%";
  document.getElementById("e").style.display = "none";
  document.getElementById("edit").style.display = "inline-block";
}
</script>

</body>

</html>
