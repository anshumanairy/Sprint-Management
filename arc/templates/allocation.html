<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>
    Allocation Dashboard
  </title>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
  <!--     Fonts and icons     -->
  <script
        src="https://code.jquery.com/jquery-3.3.1.js"
        integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
        crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
  <!-- CSS Files -->
  {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static '/bootstrap.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static '/paper-dashboard.css' %}">


  <style media="screen">
    body{
      font-size: 10px;
    }
      .scrollable-menu {
      height: auto;
      max-height: 200px;
      overflow-x: hidden;
    }
    #total{
      font-size: 15px;
    }
    #tab1{
      text-align: center;
      font-size: 10px;
      border: solid lightgrey .5px;
    }
    #tab2{
      text-align: center;
      font-size: 10px;
      border: solid lightgrey .5px;
    }
    .table{
      border: .5px solid lightgrey;
    }
    th,td{
      width:10px;
    }
    #spr{
      padding-top: 20px;
    }
    #c{
      height:40px;
      width:55px;
    }
    td{
      border: 1px solid lightgrey;
    }
    #sel,#d{
      display: inline-block;
    }
    #d{
      padding-left: 20px;
    }
  </style>
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
</head>

<body id="re">

  <div class="w3-sidebar w3-bar-block w3-card w3-animate-left" style="display:none" id="mySidebar">
    <button class="w3-bar-item w3-button w3-large"
    onclick="w3_close()">Close &times;</button>
    <a href="{% url 'product' %}" class="w3-bar-item w3-button">Product Console</a>
    <a href="{% url 'view_story' %}" class="w3-bar-item w3-button">Stories</a>
    <a href="{% url 'allocation' %}" class="w3-bar-item w3-button">Allocation Dashboard</a>
    <a href="{% url 'qaprg' %}" class="w3-bar-item w3-button">Progress</a>
    <a href="{% url 'bandwidth' %}" class="w3-bar-item w3-button">Sprint Bandwidth</a>
    <a href="{% url 'tasks' %}l" class="w3-bar-item w3-button">All Tasks</a>
    <a href="{% url 'login' %}" class="w3-bar-item w3-button"><b>Logout</b></a>
  </div>

  <div id="main">

  <div class="w3-teal">
    <button id="openNav" class="w3-button w3-teal w3-xlarge" onclick="w3_open()">&#9776;</button>
    Allocation Dashboard
  </div>

  <script>
  function w3_open() {
    document.getElementById("main").style.marginLeft = "25%";
    document.getElementById("mySidebar").style.width = "25%";
    document.getElementById("mySidebar").style.display = "block";
    document.getElementById("openNav").style.display = 'none';
  }
  function w3_close() {
    document.getElementById("main").style.marginLeft = "0%";
    document.getElementById("mySidebar").style.display = "none";
    document.getElementById("openNav").style.display = "inline-block";
  }
  </script>

  <div id="hx">
    <form class="post-form" method='POST' id="hid">
      {% csrf_token %}
      <div class="container-fluid" >
          <div class="col-md-12">
              <select class="chosen" name="select_project">
                  <option>{{ nx }}</option>
                {% for n1 in n %}
                  <option>{{ n1.name }}</option>
                {% endfor %}
              </select>
              <button class="btn btn-primary" type="submit" name="submit_project"><small>Select Project</small></button>
          </div>
      </div>
    </form>

    <form class="post-form" method='POST' id='hid1'>
      {% csrf_token %}
      <div class="container-fluid" >
          <div class="col-md-12">
            <select class="chosen" name="select_sprint">
              <option>{{ nx1 }}</option>
              {% for product in data1 %}
              <option>{{ product.name }}</option>
                {% endfor %}
            </select>
            <button class="btn btn-primary" type="submit" name="submit_sprint"><small>View Stories</small></button>
          </div>
      </div>
    </form>
  </div>

<div class="content-fluid">
  <div class="row">
    <div class="col-md-12">
      <div class="card">
        <div class="card-body" id="con">
          <div class="table-responsive" id="con">
            <table class="table" id="tab1">
              <thead class=" text-primary">
                <th>Jira ID</th>
                <th>Title</th>
                <th>JAVA</th>
                <th>PHP</th>
                <th>HTML</th>
                <th>QA</th>
                <th>Assign</th>
              </thead>
              <tbody>
                {% for dash in dashboard %}
                <tr>
                  <td><a href="{{dash.description}}" target="_blank">{{ dash.jira }}</a></td>
                  <td colspan="6"><a href="{{dash.description}}" target="_blank">{{ dash.story_name }}</a></td>
                </tr>
                <form method="GET" id="form_id{{dash.id}}">
                  {% csrf_token %}
                <tr>
                  <td colspan="2"></td>
                    <td class="t">
                    <!-- dropdown developer -->
                      <select  name="java_sel" class="chosen">
                        <option>{{ dash.dev_java }}</option>
                        {% for d22 in d2 %}
                          <option>{{ d22.name }}</option>
                        {% endfor %}
                      </select>
                  <!-- point selector -->
                      <input type="hidden" name="idx" value="{{ dash.id }}">
                      <input type="number" name="points1" min="0" value="{{ dash.javas }}" id="c">
                    </td>

                    <td class="t">
                      <!-- dropdown developer -->
                      <select name="php_sel" class="chosen">
                        <option>{{ dash.dev_php }}</option>
                        {% for d33 in d3 %}
                          <option>{{ d33.name }}</option>
                        {% endfor %}
                      </select>
                <!-- point selector -->
                      <input type="hidden" name="idx" value="{{ dash.id }}">
                      <input type="number" name="points2" min="0" value="{{ dash.phps }}" id="c">
                    </td>

                    <td class="t">
                      <!-- dropdown developer -->
                      <select name="html_sel" class="chosen">
                        <option>{{ dash.dev_html }}</option>
                        {% for d44 in d4 %}
                          <option>{{ d44.name }}</option>
                        {% endfor %}
                      </select>
                <!-- point selector -->
                      <input type="hidden" name="idx" value="{{ dash.id }}">
                      <input type="number" name="points3" min="0" value="{{ dash.htmls }}" id="c">
                    </td>

                      <td class="t">
                      <!-- dropdown developer -->
                        <select name="qa_sel" class="chosen">
                          <option>{{ dash.dev_qa }}</option>
                          {% for d55 in d5 %}
                            <option>{{ d55.name }}</option>
                          {% endfor %}
                        </select>
                  <!-- point selector -->
                        <input type="hidden" name="idx" value="{{ dash.id }}">
                        <input type="number" name="points4" min="0" value="{{ dash.qas }}" id="c">
                      </td>

                    <td><input type="submit" name="assign_data" class="btn-xs btn-info" id="reg1" value="Assign"></td>
                    </tr>
                    </form>
                    <!-- <script type="text/javascript">
                      jQuery(document).ready(function($){
                          var frm = $('#form_id{{dash.id}}');
                          frm.submit(function () {
                            if (this.id == 'form_id{{dash.id}}'){
                                $.ajax({
                                    type: $('#form_id{{dash.id}}').attr('method'),
                                    data: $('#form_id{{dash.id}}').serialize(),
                                    success: function(data) {
                                      // $("#re").html(data);
                                    },
                                });
                              return false;
                            }
                          });
                        });
                    </script> -->
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid">
  <div class="col-md-3">
    <button class="btn btn-primary btn-block"  onclick="w4_open()" id="check"><small>Check Available Developers</small></button>
  </div>
</div>

<div class="content-fluid" id="f" style="display:none">
  <div class="row">
    <div class="col-md-12">
      <div class="card">
        <div class="card-header">
          <h4 class="card-title"><b><u>Available Developers</u></b></h4>
        </div>
        <div class="card-body" id="con">
          <div class="table-responsive" id="con">
            <table class="table" id="tab2">
              <thead class=" text-primary">
                <th></th>
                <th>DEV</th>
                <th>Total</th>
                {% for d in d1 %}
                  <th>{{ d.name }}</th>
                {% endfor %}
              </thead>
              <tbody>
                <tr>
                  <td>JAVA</td>
                  <td>Bandwidth</td>
                  <td>{{ sjava }}</td>
                  {% for d in d1 %}
                    <td>{{ d.spjava }}</td>
                  {% endfor %}
                </tr>
                <tr>
                  <td></td>
                  <td>Story Points</td>
                  <td>{{ a }}</td>
                  {% for i in list1 %}
                    <td>{{ i }}</td>
                  {% endfor %}
                </tr>
                <tr>
                  <td>PHP</td>
                  <td>Bandwidth</td>
                  <td>{{ sphp }}</td>
                  {% for d in d1 %}
                    <td>{{ d.spphp }}</td>
                  {% endfor %}
                </tr>
                <tr>
                  <td></td>
                  <td>Story Points</td>
                  <td>{{ b }}</td>
                  {% for i in list2 %}
                    <td>{{ i }}</td>
                  {% endfor %}
                </tr>
                <tr>
                  <td>HTML</td>
                  <td>Bandwidth</td>
                  <td>{{ shtml }}</td>
                  {% for d in d1 %}
                    <td>{{ d.sphtml }}</td>
                  {% endfor %}
                </tr>
                <tr>
                  <td></td>
                  <td>Story Points</td>
                  <td>{{ c }}</td>
                  {% for i in list3 %}
                    <td>{{ i }}</td>
                  {% endfor %}
                </tr>
                <tr>
                  <td>QA</td>
                  <td>Bandwidth</td>
                  <td>{{ sqa }}</td>
                  {% for d in d1 %}
                    <td>{{ d.spqa }}</td>
                  {% endfor %}
                </tr>
                <tr>
                  <td></td>
                  <td>Story Points</td>
                  <td>{{ d }}</td>
                  {% for i in list4 %}
                    <td>{{ i }}</td>
                  {% endfor %}
                </tr>
              </tbody>
            </table>
            <div class="update ml-auto mr-auto">
              <button class="btn btn-primary btn-block" onclick="w4_close()"><small>Close</small></button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="m">

<script>
function w4_open() {
  document.getElementById("m").style.marginTop = "0%";
  document.getElementById("f").style.display = "block";
  document.getElementById("check").style.display = 'none';
}
function w4_close() {
  document.getElementById("m").style.marginTop = "0%";
  document.getElementById("f").style.display = "none";
  document.getElementById("check").style.display = "inline-block";
}

</script>
  </body>
</html>
